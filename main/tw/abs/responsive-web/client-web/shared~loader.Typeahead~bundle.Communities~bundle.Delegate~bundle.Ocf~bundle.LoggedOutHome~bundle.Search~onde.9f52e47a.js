"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["shared~loader.Typeahead~bundle.Communities~bundle.Delegate~bundle.Ocf~bundle.LoggedOutHome~bundle.Search~onde"],{99322:(e,t,s)=>{s.d(t,{Z:()=>n});s(2784);var i=s(90601);const o=s(73186).Z.create({initial:{alignItems:"stretch",borderWidth:0,borderStyle:"solid",boxSizing:"border-box",display:"flex",flexDirection:"column",margin:0,padding:0,position:"relative",zIndex:0,minHeight:0,minWidth:0}}),n=e=>{const{style:t,...s}=e;return(0,i.Z)("form",{...s,action:"#",style:[o.initial,t]})}},36830:(e,t,s)=>{s.d(t,{Z:()=>w});var i=s(2784),o=s(28316),n=s(25686),r=s(23162),a=s(79640),l=s(16587),d=s(90581),c=s(40159),h=(s(6886),s(5252)),u=s(73186),p=s(73228),m=s.n(p),f=s(37378);const y=m().f2b3fe06,_=u.Z.create((e=>({hidden:{visibility:"hidden"}}))),g=({isLoading:e})=>{const[t,s]=i.useState(!1);return i.useEffect((()=>{let t;return e?t=setTimeout((()=>s(!0)),f.n):s(!1),()=>clearTimeout(t)}),[e]),i.createElement(h.Z,{ariaValueText:t?y:"",indeterminate:t,style:!t&&_.hidden})};class w extends i.Component{constructor(e,t){super(e),this._setFocusedItemRef=e=>{this._shouldScrollToFocusedItem&&e&&((0,c.up)(this._getScrollParent(),e),this._shouldScrollToFocusedItem=!1)},this._resetScroll=()=>{const e=this._getScrollParent();e&&(e.scrollTop=0)},this._getFlattenedItems=(0,l.Z)((e=>(0,a.Z)(e))),this._handleItemClick=(e,t)=>{const{items:s,onItemClick:i}=this.props,o=this._getFlattenedItems(s).indexOf(e);e&&!t&&!this._shouldBlockInteractivity&&i(e,o),this._resetFocus()},this._getResultCount=()=>{const{items:e}=this.props;return this._getFlattenedItems(e).length},this._setFocusIndex=(e,t)=>{const{items:s,onItemFocusChanged:i}=this.props;this._shouldScrollToFocusedItem=t,this.setState({focusIndex:e}),i&&i(this._getFlattenedItems(s)[e])},this._resetFocus=()=>{this._setFocusIndex(this.props.withItemAlwaysSelected?0:-1)},this.focusNext=()=>{const{focusIndex:e}=this.state,t=this._getResultCount();if(0===t)return;const s=e+1>=t?0:e+1;this._setFocusIndex(s,!0)},this.focusPrevious=()=>{const{focusIndex:e}=this.state,t=this._getResultCount();if(0===t)return;const s=e-1<0?t-1:e-1;this._setFocusIndex(s,!0)},this.hasFocusedItem=()=>{const{focusIndex:e}=this.state,t=this._getResultCount();return e>=0&&t>e},this.selectFocusedItem=()=>{const{focusIndex:e}=this.state,{getItemIsDisabled:t,items:s}=this.props;if(this.hasFocusedItem()){const i=this._getFlattenedItems(s)[e],o=!!t&&t(i,i.data);this._handleItemClick(i,o)}},this.state={focusIndex:e.withItemAlwaysSelected?0:-1}}componentDidMount(){this._resetFocus()}componentWillUnmount(){clearTimeout(this._interactivityTimeout)}componentDidUpdate(e){e.items!==this.props.items&&(this._resetFocus(),this._resetScroll(),this._interactivityTimeout&&clearTimeout(this._interactivityTimeout),this._shouldBlockInteractivity=!0,this._interactivityTimeout=setTimeout((()=>{this._shouldBlockInteractivity=!1}),500))}render(){const{domId:e,isLoading:t,items:s,renderCallout:o,renderHeader:r,renderNoResultsState:a,selectedItems:l,style:d}=this.props,c=!(!t&&!s.length);let h=0;const u=!!l;return c?i.createElement(n.Z,{accessibilityMultiSelectable:u,accessibilityRole:"listbox",nativeID:e,style:d},o?o():null,i.createElement(g,{isLoading:!!t}),r?r():null,s.length?s.map(((e,t)=>{const i=!Array.isArray(s[t-1])&&t>0,o=t<s.length-1,n=Array.isArray(e)?this._renderTypeaheadGroup(e,h,i,o):this._renderTypeaheadItem(e,h);return h+=Array.isArray(e)?e.length:1,n})):null):a?a():null}_renderTypeaheadGroup(e,t,s,o){const{withSectionDivider:n}=this.props;return i.createElement(i.Fragment,{key:`typeaheadGroup-${t}`},n&&s?i.createElement(r.Z,{key:`typeaheadDividerTop-${t}`}):null,e.map(((e,s)=>this._renderTypeaheadItem(e,t+s))),n&&o?i.createElement(r.Z,{key:`typeaheadDividerBottom-${t}`}):null)}_renderTypeaheadItem(e,t){const{ariaDescendantId:s,getItemDisabledMessage:o,getItemIsDisabled:n,getUserDisplayNameLabel:r,query:a,renderUserDecoration:l,selectedItems:c,source:h,withUserHoverCard:u}=this.props,{focusIndex:p}=this.state,m=!(!c||!e.id)&&c.indexOf(e.id)>=0,f=!!c,y=p===t,_=n&&n(e,e.data),g=o&&o(e,e.data);return i.createElement(d.ZP,{disabledMessage:g,domId:y?s:void 0,getUserDisplayNameLabel:r,isDisabled:_,isFocused:y,isInMultiSelect:f,isSelected:m,item:e,key:`typeaheadItem-${t}-${e.id||""}`,onClick:this._handleItemClick,onRef:y?this._setFocusedItemRef:void 0,query:a,renderUserDecoration:l,source:h,withUserHoverCard:u})}_getScrollParent(){if(!this._scrollParent){const e=(0,c.rP)(o.findDOMNode(this));this._scrollParent=e===window?null:e}return this._scrollParent}}},45102:(e,t,s)=>{s.d(t,{Z:()=>H});var i=s(7896),o=s(2784),n=s(35193),r=s(79640),a=s(36830),l=s(31261),d=s(6800),c=s(76275),h=s(88027),u=s(37378),p=s(52612),m=s(23803),f=(s(36728),s(6886),s(24949)),y=s(11469),_=s(53223),g=s(23335),w=s(32941),I=s(92160),v=s(57851),x=s(41430),b=s(86928),C=s(57659);const D=[h.my.Users],T=e=>{const{communityId:t,filter:s,query:i,source:o,trustedFriendsId:n}=e;return(0,v.Ol)({q:i,result_type:(s||D).join(","),src:o},{communityId:t,trustedFriendsId:n})},R=(e,t)=>{const s=T(t);return(0,v.uD)(e,s)},E=(e,t)=>{const s=T(t);return(0,v.YN)(e,s)},S=(e,t)=>{const s=T(t);return(0,v.T5)(e,s)},Z=(e,t)=>{const s=T(t);return(0,v.dV)(e,s)},F=(e,t)=>(t.rounded_graph_weight||0)-(e.rounded_graph_weight||0),P=()=>(0,f.P1)(E,(0,f.P1)(((e,t)=>t.query),((e,t)=>t.filter),x.Sc,x.sM,((e,t,s,i)=>{if(!e||!t||t.indexOf(h.my.Users)<0)return(0,d.o)();const o=(0,x.UA)(s,e);return(0,h.It)(o.map((e=>i[e])).sort(F).slice(0,10))})),R,((e,t)=>t.injectedItems),((e,t)=>t.query),((e,t)=>t.getUserExactMatch),((e,t)=>t.userLimit),((e,t,s,i,o,n,r)=>{const a=(0,y.Z)(i||[],(e=>e.type===h.El.User?e.data.id_str:void 0)),l=t.filter((e=>a.indexOf(e.id)<0)),c=e.filter((e=>a.indexOf(e.id)<0)),u=(0,w.sY)(l,c).slice(0,r||10),p=s===m.ZP.LOADED,f=n&&n({query:o,hasResults:!!e.length,isLoaded:p}),_=f?[...u,f]:u;return{users:_.length?_:(0,d.o)(),userExactMatch:f,filteredPrefetchUsers:l,filteredRemoteUsers:c}})),N=()=>(0,f.P1)(P(),(0,f.P1)(S,R,((e,t)=>t.query),((e,t)=>t.maxTopics),((e,t)=>t.getTopicExactMatch),((e,t,s,i,o)=>{const n=t===m.ZP.LOADED,r=o&&o({query:s,hasResults:!!e.length,isLoaded:n}),a=e.slice(0,i||3);return r&&a.push(r),a.length?a:(0,d.o)()})),(0,f.P1)(Z,R,((e,t)=>t.query),((e,t)=>t.maxEvents),((e,t)=>t.filter),((e,t,s,i,o)=>{const n=s&&o&&o.indexOf(h.my.Events)>=0,r=e.slice(0,i||1);return r.length&&n?r:(0,d.o)()})),((e,t)=>t.injectedItems),((e,t)=>t.orderResults),((e,t,s,i,o)=>{const{users:n}=e,r=i&&i.length?i:null,a=o?o(r,n,t,s,null==e?void 0:e.filteredRemoteUsers,null==e?void 0:e.filteredPrefetchUsers,null==e?void 0:e.userExactMatch):(0,_.Z)([r,s.length?s:void 0,t.length?t:void 0,n.length?n:void 0]);return t.length||n.length||s.length?a:r?[r]:(0,d.o)()})),U=(0,I.Z)().propsFromState((()=>({fetchStatus:R,items:N()}))).propsFromActions((()=>({createLocalApiErrorHandler:(0,g.createLocalApiErrorHandlerWithContextFactory)("TYPEAHEAD_DROPDOWN_CONTAINER_CONTEXT"),fetchTypeaheadIfNeeded:v.o4,fetchUsersIfNeeded:C.ZP.fetchManyIfNeeded,fetchUsersPresenceIfNeeded:b.ZP.fetchManyIfNeeded,prefetchTypeaheadUsersIfNeeded:x.zP}))).withAnalytics({element:"typeahead"});class k extends o.Component{constructor(e,t){super(e,t),this._fetchUsersIfNeeded=(e=[])=>{const{fetchUsersIfNeeded:t,items:s,source:i}=this.props;if(this.context.featureSwitches.isTrue("follow_nudge_search_enabled")&&this.context.loggedInUserId&&i===h._4.SearchBox){const i=(0,r.Z)(e).filter((e=>e.type===p.ZP.User)).map((e=>e.id)),o=(0,r.Z)(s).filter((e=>e.type===p.ZP.User)).filter((e=>!i.includes(e.id))).map((e=>e.id));(null==o?void 0:o.length)&&t(o)}},this._fetchTypeaheadResultsIfNeeded=e=>{const t=this.context.featureSwitches.isTrue("c9s_community_composer_hashtag_suggestions_enabled");e.query&&e.fetchTypeaheadIfNeeded({q:e.query,src:e.source,result_type:e.filter.join(","),context_text:e.contextText,topic_type:e.topicType,context_community_id:t?e.communityId:void 0},{communityId:e.communityId,trustedFriendsId:e.trustedFriendsId}).catch(e.createLocalApiErrorHandler({}))},this._handleItemClick=(e,t)=>{const{analytics:s,onItemClick:i,query:o}=this.props;i(e,t);const n=c.Z.forTypeaheadResult(e,t),r=n?[n]:void 0;s.scribe({action:"click",data:{search_details:{query:o},targets:r}})},this._scribeResults=()=>{const{analytics:e,items:t,query:s}=this.props;e.scribe({action:"impression",data:{items:c.Z.forTypeaheadResults(t),search_details:{query:s}}})},this._debouncedFetchTypeaheadResultsIfNeeded=(0,n.Z)(this._fetchTypeaheadResultsIfNeeded,250),this.state={shouldShowPrefetchResults:!0},this._previouslyLoadedResults=(0,d.o)()}componentDidMount(){const{createLocalApiErrorHandler:e,prefetchTypeaheadUsersIfNeeded:t}=this.props;this._debouncedFetchTypeaheadResultsIfNeeded(this.props),t().catch(e({})),this._fetchUsersIfNeeded()}componentWillUnmount(){clearTimeout(this._prefetchResultsTimer)}componentDidUpdate(e){const{createLocalApiErrorHandler:t,domId:s,fetchUsersPresenceIfNeeded:i,filter:o,items:n,onItemsChanged:a,query:l,shouldDeferPrefetch:d,source:c}=this.props,{filter:h,query:f,source:y}=e,{loggedInUserId:_}=this.context,g=this.context.featureSwitches.isTrue("voice_rooms_typeahead_audiospace_ring_enabled")&&_;if(null!=n&&n.length&&n!==e.items){if(this._scribeResults(),a){let e=!1;const t=s?document.getElementById(s):null;t&&t.scrollHeight>t.offsetHeight&&(e=!0),a(n,e)}if(g){const e=(0,r.Z)(n).filter((e=>e.type===p.ZP.User)).map((e=>e.id));e&&i(e).catch(t({}))}this._fetchUsersIfNeeded(e.items)}e.fetchStatus===m.ZP.LOADED&&(this._previouslyLoadedResults=e.items),l===f&&o===h&&c===y||(this._debouncedFetchTypeaheadResultsIfNeeded(this.props),d&&(clearTimeout(this._prefetchResultsTimer),this.setState({shouldShowPrefetchResults:!1}),this._prefetchResultsTimer=setTimeout((()=>{this.props.query&&this.props.fetchStatus!==m.ZP.LOADED&&this.setState({shouldShowPrefetchResults:!0})}),u.n)))}render(){const{analytics:e,communityId:t,contextText:s,createLocalApiErrorHandler:n,dropdownRef:r,fetchStatus:l,fetchTypeaheadIfNeeded:d,fetchUsersIfNeeded:c,fetchUsersPresenceIfNeeded:h,filter:u,getTopicExactMatch:p,getUserExactMatch:f,injectedItems:y,items:_,maxEvents:g,maxTopics:w,onItemClick:I,onItemsChanged:v,orderResults:x,prefetchTypeaheadUsersIfNeeded:b,query:C,shouldDeferPrefetch:D,topicType:T,trustedFriendsId:R,userLimit:E,...S}=this.props,Z=C&&l!==m.ZP.LOADED;let F;return F=Z?this.state.shouldShowPrefetchResults&&_.length?_:this._previouslyLoadedResults:_,o.createElement(a.Z,(0,i.Z)({},S,{isLoading:!!Z,items:F,onItemClick:this._handleItemClick,query:C,ref:r}))}}k.contextType=l.rC,k.defaultProps={filter:[h.my.Users],injectedItems:[],maxEvents:3,maxTopics:1};const L=o.forwardRef(((e,t)=>o.createElement(k,(0,i.Z)({},e,{dropdownRef:t})))),H=U.forwardRef(L)},74383:(e,t,s)=>{s.r(t),s.d(t,{TypeaheadInput:()=>R,default:()=>S,styles:()=>E});var i=s(7896),o=s(2784),n=s(25686),r=s(22150),a=s(35030),l=s(86242),d=s(54044),c=s(73186),h=s(73228),u=s.n(h),p=s(54170),m=s(99322),f=s(45102),y=s(27036),_=s(95254),g=s(52008),w=s(77559),I=s(79075),v=s(88027),x=s(32941),b=s(31261);const C=u().f065ba8c,D=e=>g.Z.isTwoColumnNormalLayout(e)?{width:y.Z.columnWidths.secondary.normal+c.Z.theme.spacesPx.space24,left:-c.Z.theme.spacesPx.space24/2}:g.Z.isTwoColumnSmallLayout(e)?{width:y.Z.columnWidths.secondary.small+c.Z.theme.spacesPx.space16,left:-c.Z.theme.spacesPx.space16/2}:void 0;let T=1;class R extends o.Component{constructor(e,t){super(e,t),this._withNewTypeaheadUI=!1,this._render=({containerWidth:e})=>{const{alwaysOpen:t,disableClearButton:s,forceVdlDisable:l,inputStyle:d,isCompact:c,isOnHomepage:h,placeholder:u,renderCustomInput:f,renderInSearchField:y,rounded:_,shouldAutoFocus:g,shouldFocusOnClear:w,style:I,testID:v}=this.props,x=this.state.showTypeaheadDropdown||t,b={Icon:p.default,ariaActiveDescendant:this.state.ariaDescendantId,ariaAutocomplete:"list",ariaExpanded:x,ariaLabel:C,ariaOwns:this._dropdownDomId,ariaRole:"combobox",autoComplete:"off",autoCorrect:!1,autoFocus:g,contentBelow:y&&y(),focusOnClear:w,isCompact:c,leftAligned:h,onBlur:this._handleInputBlur,onChange:this._handleInputChange,onClear:this._handleInputClear,onFocus:this._handleInputFocus,onLayout:this._handleInputLayoutChanged,placeholder:u,returnKeyType:"search",spellCheck:"false",styleType:l?"legacyPill":_?"pill":"selection",testID:v,value:this.state.query,withClearButton:!s&&this.state.showTypeaheadDropdown};return o.createElement(n.Z,{onLayout:this._handleLayout,ref:this._setRootContainerNode,style:[E.root,I]},o.createElement(a.Z,{onKeyDown:this._handleKeyDown,style:E.keydownInputListener},o.createElement(m.Z,{accessibilityLabel:u,accessibilityRole:"search",onSubmit:this._handleFormSubmit,style:E.wrapper},o.createElement(n.Z,{ref:this._setInputContainerNode,style:d},f?f({...b,handleReturn:this._handleRichTextInputReturn}):o.createElement(r.Z,(0,i.Z)({},b,{ref:this._setInputRef}))),o.createElement(n.Z,{style:[E.typeaheadContainer,!_&&E.topBorder]},x?this._renderDropdown(e):null))))},this._renderDropdown=e=>{const{communityId:t,filter:s,getItemDisabledMessage:i,getItemIsDisabled:n,getTopicExactMatch:r,getUserDisplayNameLabel:a,getUserExactMatch:l,injectedItems:d,isInSidebar:h,isModal:u,isOnHomepage:p,maxEvents:m,maxTopics:y,onItemsChanged:_,orderResults:g,renderCallout:I,renderCustomDropdown:v,renderEmptyState:b,renderHeader:C,renderNoResultsState:T,renderUserDecoration:R,selectedItems:S,shouldDeferPrefetch:Z,source:F,trustedFriendsId:P,userLimit:N,withFixedPositioning:U,withSectionDivider:k,withUserHoverCard:L}=this.props,H=e>=c.Z.theme.breakpoints.medium||(0,w.ZP)(),{dropdownOffset:M,query:O}=this.state,A=u?E.modalDropdown:[E.dropdown,!H&&U&&M?[(0,x.xX)(M),{height:`calc(100vh - ${M}px)`}]:null,(H||p)&&E.wideModeDropdown,this._withNewTypeaheadUI&&h&&D(e),p&&E.shortModeDropdown,!H&&p&&E.shortModeDropdownMobile],B={ariaDescendantId:this.state.ariaDescendantId,domId:this._dropdownDomId,onDismiss:this._handleOnEmptyStateDismiss,onItemFocusChanged:this._handleItemFocusChanged,ref:this._handleDropdownRef,style:A},q={ariaDescendantId:this.state.ariaDescendantId,communityId:t,domId:this._dropdownDomId,filter:s,getItemDisabledMessage:i,getItemIsDisabled:n,getTopicExactMatch:r,getUserDisplayNameLabel:a,getUserExactMatch:l,injectedItems:d,maxEvents:m,maxTopics:y,onItemClick:this._handleItemClick,onItemFocusChanged:this._handleItemFocusChanged,onItemsChanged:_,orderResults:g,query:O,ref:this._handleDropdownRef,renderCallout:I,renderHeader:C,renderNoResultsState:T,renderUserDecoration:R,selectedItems:S,shouldDeferPrefetch:Z,source:F,style:A,trustedFriendsId:P,userLimit:N,withSectionDivider:k,withUserHoverCard:L};return b&&!O?b(B):v?v(q):o.createElement(f.Z,q)},this._dismissDropdown=()=>{this.setState({showTypeaheadDropdown:!1}),this.props.onDismiss&&this.props.onDismiss()},this._handleOnEmptyStateDismiss=()=>{this._dismissDropdown(),this._inputRef&&this._inputRef.blur()},this._handleLayout=()=>{this._updatePosition()},this._handleInputLayoutChanged=()=>{this._updatePosition()},this._updatePosition=()=>{if(!this._inputContainerNode)return;const{bottom:e}=this._inputContainerNode.getBoundingClientRect();e!==this.state.dropdownOffset&&this.setState({dropdownOffset:e})},this._handleDropdownRef=e=>{this._dropdownRef=e},this._setRootContainerNode=e=>{this._rootContainerNode=e||null},this._setInputRef=e=>{this._inputRef=e,this._activeChildRef||(this._activeChildRef=e)},this._setInputContainerNode=e=>{this._inputContainerNode=e||null,this._inputContainerNode&&this._updatePosition()},this._handleFocusChange=e=>{const t=l.Z.getCount()>0;this._rootContainerNode&&this._rootContainerNode.contains(e.target)||t||this.state.showTypeaheadDropdown&&this._dismissDropdown()},this._handleKeyDown=e=>{const{key:t,shiftKey:s}=e,{alwaysOpen:i}=this.props,{showTypeaheadDropdown:o}=this.state;if((0,x.kE)(e))if(t!==I.Dd){if(this.state.inputHasFocus)return t===I.WX?(this._focusNext(),void e.preventDefault()):t===I.kl?(this._focusPrevious(),void e.preventDefault()):t===I.nQ&&!i&&o?(this._dismissDropdown(),void e.preventDefault()):t===I.NW&&this._hasFocusedItem()?(this._selectFocusedItem(),void e.preventDefault()):void(t!==I.jF&&t!==I.Ci||!this._deleteFocusedItem()?o||this.setState({showTypeaheadDropdown:!0}):e.preventDefault())}else{const t=s&&this._navigatePrevious()||!s&&this._navigateNext();t?(this._activeChildRef=t,e.preventDefault(),t.focus()):this._dismissDropdown()}},this._handleItemFocusChanged=()=>{this.setState({ariaDescendantId:(0,x.A1)()})},this._handleInputClear=()=>{this.setQuery("")},this._handleInputBlur=()=>{this.setState({inputHasFocus:!1}),this.props.onBlur&&this.props.onBlur()},this._handleInputFocus=()=>{this._activeChildRef=this._inputRef,this.setState({inputHasFocus:!0,showTypeaheadDropdown:!0}),this._updatePosition(),this.props.onFocus&&this.props.onFocus()},this._handleRichTextInputReturn=e=>e.shiftKey?"not-handled":(this._hasFocusedItem()||this._handleFormSubmit(e),"handled"),this._handleInputChange=e=>{this.setQuery(e.target.value),this._updatePosition()},this._handleFormSubmit=e=>{e.preventDefault(),e.stopPropagation(),this._inputRef&&this._inputRef.blur(),this.setState({showTypeaheadDropdown:!1}),this.props.onDismiss&&this.props.onDismiss(),this.props.onSubmit&&this.props.onSubmit()},this._handleItemClick=(e,t)=>{const{onDismiss:s,onItemClick:i,shouldClearOnSelect:o,shouldFocusOnClear:n}=this.props,r=o?"":this.state.query;this.setState({showTypeaheadDropdown:!1}),this._inputRef&&(o&&n?this._inputRef.focus():this._inputRef.blur()),this.setQuery(r),s&&s(),i&&i(e,t)},this._hasFocusedItem=()=>this._dropdownRef&&this._dropdownRef.hasFocusedItem(),this._deleteFocusedItem=()=>!!(this._dropdownRef&&this._dropdownRef.deleteFocusedItem&&this._dropdownRef.hasFocusedItem()&&this._dropdownRef.deleteFocusedItem()),this._selectFocusedItem=()=>{this._dropdownRef&&this._dropdownRef.selectFocusedItem()},this._focusNext=()=>{this._dropdownRef&&this._dropdownRef.focusNext()},this._focusPrevious=()=>{this._dropdownRef&&this._dropdownRef.focusPrevious()},this._navigateNext=()=>{if(this._dropdownRef&&this._dropdownRef.navigateNext)return this._dropdownRef.navigateNext()},this._navigatePrevious=()=>{if(!this.state.inputHasFocus&&this._dropdownRef&&this._dropdownRef.navigatePrevious)return this._dropdownRef.navigatePrevious()||this._inputRef},this.state={ariaDescendantId:(0,x.A1)(),inputHasFocus:!1,query:e.initialValue,showTypeaheadDropdown:!1},this._dropdownDomId=`typeaheadDropdown-${T}`,T+=1,this._withNewTypeaheadUI=this.context.featureSwitches.isTrue("responsive_web_account_search_readability_enabled")}componentDidUpdate(e){this.props.initialValue!==e.initialValue&&this.setQuery(this.props.initialValue)}componentDidMount(){window.document.addEventListener("click",this._handleFocusChange,!0)}componentWillUnmount(){window.document.removeEventListener("click",this._handleFocusChange,!0)}render(){return o.createElement(d.Z,null,this._render)}focus(){this._activeChildRef&&this._activeChildRef.focus()}setQuery(e){this.setState({query:e}),this.props.onQueryChange&&this.props.onQueryChange(e)}}R.defaultProps={disableClearButton:!1,filter:[v.my.Users,v.my.Topics],isInSidebar:!1,initialValue:"",withSectionDivider:!0,withUserHoverCard:!1},R.contextType=b.rC;const E=c.Z.create((e=>({root:{flex:1,flexDirection:"column",position:"relative",zIndex:_.R0+1},typeaheadContainer:{flex:1,position:"relative"},keydownInputListener:{flexShrink:1,width:"100%"},dropdown:{backgroundColor:e.colors.cellBackground,start:0,end:0,overflowY:"auto",overscrollBehavior:"contain",position:"absolute",top:0,WebkitOverflowScrolling:"touch"},modalDropdown:{backgroundColor:e.colors.cellBackground,flex:1,minHeight:300,position:"relative",overflowY:"auto",overscrollBehavior:"auto",WebkitOverflowScrolling:"touch"},wideModeDropdown:{borderRadius:e.borderRadii.medium,boxShadow:e.boxShadows.medium,minHeight:100,maxHeight:`calc(80vh - ${e.componentDimensions.appBarHeight})`},shortModeDropdown:{minHeight:100,maxHeight:"35vh",paddingBottom:"0"},shortModeDropdownMobile:{position:"absolute",height:"40vh",top:0},wrapper:{alignItems:"stretch",flex:1},topBorder:{borderTopColor:e.colors.gray200,borderTopStyle:"solid",borderTopWidth:e.borderWidths.small}}))),S=R},86045:(e,t,s)=>{s.d(t,{Z:()=>d});var i=s(2784),o=s(25686),n=s(35953),r=s(36934),a=s(44329);const l=s(73186).Z.create((e=>({root:{flexDirection:"row",flexShrink:1,flexGrow:1},bodyColumn:{justifyContent:"center",flexDirection:"column",marginEnd:e.spaces.space4,marginStart:e.spaces.space12,flexShrink:1},coverContainer:{borderRadius:e.borderRadii.large,overflow:"hidden"},cellThumbnail:{height:e.spaces.space48,width:e.spaces.space48},largeCellThumbnail:{height:e.spaces.space56,width:e.spaces.space56}}))),d=function(e){const{image:t,style:s,supportText:d,title:c,withNewTypeaheadUI:h}=e;return i.createElement(o.Z,{style:[l.root,s]},i.createElement(o.Z,{style:[l.coverContainer,h?l.largeCellThumbnail:l.cellThumbnail]},t?i.createElement(n.Z,{accessibilityLabel:"",aspectMode:a.Z.SQUARE,image:t}):null),i.createElement(o.Z,{style:l.bodyColumn},d?i.createElement(r.ZP,{color:"gray700",numberOfLines:1,size:"subtext2"},d):null,i.createElement(r.ZP,{numberOfLines:2,weight:"bold"},c)))}},90581:(e,t,s)=>{s.d(t,{ib:()=>le,ZP:()=>oe});var i=s(2784),o=s(25686),n=s(36934),r=s(74062),a=s(73186),l=s(7066),d=s(33363),c=s(88027),h=s(31261),u=s(37541),p=s(23837),m=s(41266),f=s(84515),y=s(92160),_=s(92157),g=s(57659);const w=(e,t)=>t.conversationId,I=(e,t)=>(0,_.x)(e,w(0,t)),v=(0,y.Z)().propsFromState((()=>({conversationId:w,conversation:I,users:g.ZP.selectAll}))).adjustStateProps((({conversation:e,conversationId:t,users:s})=>{const i={conversation:void 0};return null!=e&&e.data&&(i.conversation=(0,f.E5)(e.data,void 0,s)),i})),x=a.Z.create((e=>({root:{cursor:"pointer",paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical,width:"100%"},avatarColumn:{flexGrow:1,maxWidth:e.spaces.space40,minWidth:"32px"},bodyColumn:{flexGrow:7,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},disabled:{opacity:.6,backgroundColor:e.colors.gray0}}))),b=v((({conversation:e,isDisabled:t,isSelected:s,perspective:o})=>e?i.createElement(u.Z,{avatarCell:i.createElement(p.Z,{conversation:e,perspective:o,size:"xLarge"}),avatarCellStyle:x.avatarColumn,avatarSize:"xLarge",cellStyle:x.bodyColumn,style:[x.root,!s&&t&&x.disabled]},i.createElement(m.Z,{conversation:e,perspective:o,withParticipantsCount:!0}),le({isSelected:s})):null));var C=s(35953),D=s(44329),T=s(12934),R=s(59890);class E extends i.PureComponent{render(){const{event:e,image:t,supportText:s}=this.props;return i.createElement(o.Z,{style:Z.root},i.createElement(R.Z,{withGutter:!0},i.createElement(o.Z,{style:Z.bodyColumn},s?i.createElement(n.ZP,{color:"gray700",size:"subtext2"},s):null,i.createElement(n.ZP,{numberOfLines:1},e)),t?i.createElement(o.Z,{style:Z.coverContainer},i.createElement(T.Z,{ratio:1},i.createElement(C.Z,{accessibilityLabel:"",aspectMode:D.Z.SQUARE,image:t}))):null))}}const S="100px",Z=a.Z.create((e=>({root:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},bodyColumn:{flexGrow:7,justifyContent:"center"},coverContainer:{backgroundColor:e.colors.gray200,borderRadius:e.borderRadii.small,flexGrow:1,justifyContent:"flex-end",maxHeight:S,maxWidth:S,overflow:"hidden",width:"25%"}}))),F=E;var P=s(86045),N=s(92280),U=s(38749),k=s(10891),L=s(80166),H=(s(53985),s(36728),s(85940),s(35903)),M=s.n(H);const O=a.Z.create((e=>({root:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},context:{alignItems:"center",flexDirection:"row"},icon:{color:e.colors.primary,height:e.fontSizes.subtext2,paddingEnd:e.spaces.space4,width:e.fontSizes.subtext2},disabled:{backgroundColor:e.colors.gray0},searchIcon:{marginEnd:e.spaces.space12,borderWidth:0,backgroundColor:"none"},searchIconCell:{flexDirection:"row",alignItems:"center"},wrapperCellStyle:{justifyContent:"center"}}))),A=function(e){const{featureSwitches:t}=i.useContext(h.rC),{isDisabled:s,query:r,resultContext:a,showIcon:l,style:d,topic:c,withNewTypeaheadUI:p}=e,m=function(e,t,s=!1){const i=M()(e),o=e.toLowerCase().indexOf(t.toLowerCase()),n=o+t.length;let r;if(0===i.length){const t=s?[o>0?[0,o]:void 0,[n,e.length]].filter(Boolean):[[o,n]];r=[{highlights:-1!==o?t:void 0,text:e,entityType:"text",prefix:"",indices:[0,e.length]}]}else{const t=i.flatMap((({indices:t},s,i)=>{const o=0===s?0:i[s-1].indices[1],n=s===i.length-1,r=[];return o!==t[0]&&r.push(e.slice(o,t[0])),r.push(e.substring(t[0],t[1])),n&&e.length!==t[1]&&r.push(e.slice(t[1])),r}));let a=0;const l=t.map(((e,t,s)=>{a+=t>0?s[t-1].length:0;const i=e.length;return{runningTotal:a,containsQuery:-1!==o&&a+i>=o&&a<n}}));r=t.map(((e,t)=>{var i;const{containsQuery:r,runningTotal:a}=l[t],d=e.includes("#");let c,h;if(s&&!r)c=[[0,e.length]];else if(r){let t=a<o?o-a:0,i=a+e.length<n?e.length:n-a;d&&(t-=1,i-=1),s?(c=[],t>0&&c.push([0,t]),i!==e.length-1&&c.push([i,e.length])):c=[[t,i]]}return null!=(i=c)&&i.length&&(h=c),d?{highlights:h,text:`${null==e?void 0:e.replace("#","")}`,entityType:"hashtag",prefix:"#",indices:[a,a+e.length]}:{highlights:h,text:e,entityType:"text",prefix:"",indices:[a,a+e.length]}}))}return r}(c,t.isTrue("responsive_web_typeahead_reverse_bolding_enabled")?r:"",true),f=i.createElement(n.ZP,null,m.map(((e,t)=>i.createElement(N.ZP,{key:`${e.text}${t}`,part:e})))),y=p?"xxxLarge":"xLarge",_=i.createElement(i.Fragment,null,f,a?i.createElement(o.Z,{style:O.context},a&&a.types[0]&&"followable_topic"===a.types[0].type?i.createElement(L.default,{style:O.icon}):null,i.createElement(n.ZP,{color:"gray700"},a.display_string||" ")):null);return i.createElement(o.Z,{style:[O.root,s&&O.disabled,d]},l?(e=>{const t=i.createElement(U.Z,{Icon:k.default,color:"neutral",size:y,style:O.searchIcon});return i.createElement(u.Z,{avatarCell:t,avatarCellStyle:O.searchIconCell,avatarSize:y,cellStyle:O.wrapperCellStyle},e)})(_):_)};s(6886);var B=s(54044),q=s(19153),z=s(73228),V=s.n(z),W=s(35210),j=s(86928);const Q=(e,t)=>(0,j.cY)(e,t.userId),G=(0,y.Z)().propsFromState((()=>({userSpace:Q}))),$="TypeaheadUser",Y=V().ae2205d2,K=V().d960b55c,X=V().fd06b02f,J=Object.freeze({num_of_followers:W.Z.Follow,bio:W.Z.TextOnly,location:W.Z.Location,num_tweets:W.Z.NewTweets,follow_relationship:W.Z.Follow,followers_follow:W.Z.Follow,social_proof:W.Z.SocialProof,follow_relationship_mutual_follow:W.Z.FollowMutual,follow_relationship_followed:W.Z.FollowFollowed,follow_relationship_following:W.Z.FollowFollowing,highlighted_label:"HighlightedIcon"});class ee extends i.PureComponent{constructor(...e){super(...e),this._handleAvatarClick=()=>{const{userSpace:e}=this.props;e||this._handleClick()},this._handleClick=()=>{const{isDisabled:e,item:t,onItemClick:s}=this.props;s&&s(t,!!e)}}render(){const{affiliateBadgeInfo:e,avatarUri:t,decoration:s,disabledMessage:o,displayNameLabel:n,isBlueVerified:r,isDisabled:l,isProtected:d,isVerified:h,name:u,screenName:p,source:m,userId:f,userSpace:y,verifiedType:_,withHoverCard:g,withNewTypeaheadUI:w}=this.props,{featureSwitches:I}=this.context,{context:v,highlightedLabel:x}=this._getItemContext(),b=m===c._4.SearchBox,C=y&&I.isTrue("voice_rooms_typeahead_audiospace_ring_enabled")?y:void 0;return C&&(C.accessibilityLabel=X({screenName:p})),i.createElement(B.Z,null,(({windowWidth:c})=>{const m=c>a.Z.theme.breakpoints.small?"xxxLarge":"xxLarge";return i.createElement(q.ZP,{affiliateBadgeInfo:e,avatarSize:w?m:"xLarge",avatarUri:t,decoration:s,disabledMessage:l?o:void 0,displayMode:w?"ExperimentalUserTypeahead":"UserCompact",displayNameLabel:n,highlightedLabel:x,isBlueVerified:r,isDisabled:l,isProtected:d,isVerified:h,name:u,onAvatarClick:this._handleAvatarClick,onCellClick:this._handleClick,onScreenNameClick:this._handleClick,presenceIndicator:b?C:void 0,screenName:p,socialContext:v,testID:$,userId:f,verifiedType:_,withInteractiveStyling:!1,withLink:g})}))}_getItemContext(){const e=this._getResultContext();return{highlightedLabel:null==e?void 0:e.highlightedLabel,context:null!=e&&e.highlightedLabel?void 0:e||this._getSocialContext()}}_getSocialContext(){const{socialContext:e}=this.props;if(!e||!e.following)return;const t=e.followed_by?Y:K;return{contextType:W.Z.Follow,text:t}}_getResultContext(){const{resultContext:e,withNewTypeaheadUI:t}=this.props;if(!(t&&e&&e.display_string&&e.types))return;const{display_string:s,icon_url:i,types:o}=e,n=o.length?o[0].type:void 0,r=n&&n in J?J[n]:W.Z.TextOnly;return{contextType:r,text:s,highlightedLabel:r===J.highlighted_label&&i?{badge:{url:i},description:s}:void 0}}}ee.contextType=h.rC,ee.defaultProps={withNewTypeaheadUI:!1,withHoverCard:!1};const te=G.forwardRef(ee),se="typeaheadResult",ie=({children:e})=>e;function oe(e){return i.createElement(ie,{item:e.item},i.createElement(re,e))}const ne=[c._4.SearchBox,c._4.Compose];class re extends i.Component{constructor(e,t){super(e,t),this._onViewRef=e=>{this._viewRef=e;const{onRef:t}=this.props;t&&t(e)},this._handleClick=()=>{const{item:e}=this.props;e.type!==c.El.User&&this.props.onClick&&this.props.onClick(e,this.isDisabled)},this._withNewTypeaheadUI=this.context.featureSwitches.isTrue("responsive_web_account_search_readability_enabled")}componentDidMount(){this._loaded=!0,this._viewRef&&(this._rafId=window.requestAnimationFrame((()=>{this._viewRef&&this._viewRef.setNativeProps({style:{opacity:1}})})))}componentDidUpdate(e){const{onRef:t}=this.props;t&&t!==e.onRef&&this._viewRef&&t(this._viewRef)}componentWillUnmount(){this._rafId&&window.cancelAnimationFrame(this._rafId)}render(){const{domId:e,isDisabled:t,isFocused:s,isInMultiSelect:n,isSelected:a,style:l}=this.props;return i.createElement(o.Z,{accessibilityChecked:!(!n||!a)||void 0,accessibilityRole:"option",accessibilitySelected:t?void 0:n&&a||!n&&!!s,nativeID:e,testID:se},i.createElement(r.Z,{accessibilityRole:n?"checkbox":"button",disabled:t,focusable:!0,onPress:this._handleClick,style:[s&&ae.focused,ae.transitionStyles,this._loaded&&ae.loaded,l],viewRef:this._onViewRef},this._renderResult()))}_renderResult(){const{disabledMessage:e,getUserDisplayNameLabel:t,isDisabled:s,isSelected:r,item:a,onClick:l,renderUserDecoration:h,source:u,withUserHoverCard:p}=this.props;switch(a.type){case c.El.User:{const{data:o}=a,n=h?h({userId:o.id_str,user:o,isSelected:r}):void 0,d=t?t(a,o):void 0;return i.createElement(te,{affiliateBadgeInfo:o.highlightedLabel,avatarUri:o.profile_image_url_https,canDm:!!o.can_dm,canMediaTag:!!o.can_media_tag,decoration:n||void 0,disabledMessage:e,displayNameLabel:d,isBlueVerified:o.is_blue_verified,isDisabled:s,isProtected:!!o.protected,isVerified:!!o.verified,item:a,name:o.name,onItemClick:l,resultContext:o.result_context,screenName:o.screen_name,socialContext:o.social_context,source:u,userId:o.id_str,verifiedType:o.verified_type,withHoverCard:p,withNewTypeaheadUI:this._withNewTypeaheadUI&&ne.includes(u)})}case c.El.Event:{const{data:e}=a;return this._withNewTypeaheadUI?i.createElement(P.Z,{image:e.primary_image&&e.primary_image.original_info,style:ae.itemPadding,supportText:e.supporting_text,title:e.topic,withNewTypeaheadUI:!0}):i.createElement(F,{event:e.topic,image:e.primary_image&&e.primary_image.original_info,supportText:e.supporting_text})}case c.El.Hashtag:case c.El.Topic:{const{query:e}=this.props,{data:t}=a,o=u===c._4.SearchBox;return i.createElement(A,{isDisabled:s,query:e||"",resultContext:t.result_context,showIcon:o,style:o?ae.itemPadding:void 0,topic:t.topic,withNewTypeaheadUI:this._withNewTypeaheadUI})}case c.El.DMConversation:return!!this.context.loggedInUserId&&i.createElement(b,{conversationId:a.id,isDisabled:s,isSelected:r,perspective:this.context.loggedInUserId});case c.El.SettingGroup:{const{text:e}=a.data;return i.createElement(o.Z,{style:ae.navigationLink},i.createElement(n.ZP,{style:ae.content,weight:"bold"},e),i.createElement(d.default,{style:ae.icon}))}case c.El.Setting:{const{text:e}=a.data;return i.createElement(o.Z,{style:ae.navigationLink},i.createElement(n.ZP,{style:ae.content},e),i.createElement(d.default,{style:ae.icon}))}case c.El.NoResult:{const{data:e}=a,{text:t}=e;return i.createElement(n.ZP,{style:ae.noResult},t)}default:return null}}get isDisabled(){return!!this.props.isDisabled}}re.contextType=h.rC;const ae=a.Z.create((e=>({checkIcon:{color:e.colors.primary},navigationLink:{alignItems:"center",flexDirection:"row",flexGrow:1,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},content:{flexGrow:1,flexShrink:1},icon:{color:e.colors.gray700,paddingStart:e.spaces.space12,flexShrink:0},noResult:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},itemPadding:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},loaded:{opacity:1},focused:{backgroundColor:e.colors.gray0},transitionStyles:{transitionProperty:"opacity",transitionDuration:"250ms",opacity:0}}))),le=({isSelected:e})=>e?i.createElement(l.default,{accessibilityHidden:!0,style:ae.checkIcon}):null},6800:(e,t,s)=>{s.d(t,{o:()=>o});var i=s(16742);const o=(0,i.Z)([]);(0,i.Z)({})},79075:(e,t,s)=>{s.d(t,{Ci:()=>c,Dd:()=>l,NW:()=>n,Ur:()=>a,WX:()=>i,jF:()=>d,kl:()=>o,nQ:()=>r});const i="ArrowDown",o="ArrowUp",n="Enter",r="Escape",a="ESC",l="Tab",d="Delete",c="Backspace"},92157:(e,t,s)=>{s.d(t,{x:()=>o});var i=s(34562);const o=(e,t)=>e[i.Yf]?e[i.Yf].conversations[t]:null},10891:(e,t,s)=>{s.r(t),s.d(t,{default:()=>a});var i=s(2784),o=s(90601),n=s(73569);const r=(e={})=>(0,o.Z)("svg",{...e,accessibilityRole:e.accessibilityLabel?e.accessibilityRole||"img":void 0,accessibilityHidden:void 0===e.accessibilityLabel,style:[n.Z.root,e.style],viewBox:"0 0 21 21",children:i.createElement("g",null,i.createElement("path",{d:"M9.094 3.095c-3.314 0-6 2.686-6 6s2.686 6 6 6c1.657 0 3.155-.67 4.243-1.757 1.087-1.088 1.757-2.586 1.757-4.243 0-3.314-2.686-6-6-6zm-9 6c0-4.971 4.029-9 9-9s9 4.029 9 9c0 1.943-.617 3.744-1.664 5.215l4.475 4.474-2.122 2.122-4.474-4.475c-1.471 1.047-3.272 1.664-5.215 1.664-4.97-.001-8.999-4.03-9-9z"}))});r.metadata={width:21,height:21};const a=r}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~loader.Typeahead~bundle.Communities~bundle.Delegate~bundle.Ocf~bundle.LoggedOutHome~bundle.Search~onde.9f52e47a.js.map
